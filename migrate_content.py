#!/usr/bin/env python3
"""
–°–∫—Ä–∏–ø—Ç –º–∏–≥—Ä–∞—Ü–∏–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –∏–∑ old/content/ –≤ –Ω–æ–≤—É—é S2R —Å—Ç—Ä—É–∫—Ç—É—Ä—É
"""

import os
import shutil
from pathlib import Path
from typing import Dict, List

# –ö–æ—Ä–µ–Ω—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
REPO_ROOT = Path("/Users/tserentserenov/Github/ecosystem-development")
OLD_CONTENT = REPO_ROOT / "old/content"

# –ú–∞–ø–ø–∏–Ω–≥ —Å—Ç–∞—Ä—ã—Ö –ø—É—Ç–µ–π –Ω–∞ –Ω–æ–≤—ã–µ
MAPPING: Dict[str, List[str]] = {
    # 0. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ ‚Üí 0.OPS/
    "0. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ/0.1. –õ–æ–≥–∏–∫–∞ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ –∏ –∑–Ω–∞–Ω–∏–π": [
        "0.OPS/0.1.Knowledge-Logic"
    ],
    "0. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ/0.2. –ü—Ä–æ—Ü–µ—Å—Å—ã —Ä–∞–±–æ—Ç—ã —Å —Ö—Ä–∞–Ω–∏–ª–∏—â–µ–º": [
        "0.OPS/0.6.Repository-Processes"
    ],
    "0. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ/0.3. –ü–ª–∞–Ω—ã –∏ —Å–æ–≤–µ—â–∞–Ω–∏—è": [
        "0.OPS/0.7.Plans-and-Meetings"
    ],
    "0. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ/0.4. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ—Ç—á—ë—Ç—ã –ò–ò": [
        "0.OPS/0.5.AI-Reports"
    ],
    "0. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ/0.9. –í—Ö–æ–¥—è—â–∏–µ": [
        "0.OPS/0.9.Inbox"
    ],
    "0. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ/0.99. –ê—Ä—Ö–∏–≤": [
        "0.OPS/0.99.Archive"
    ],
    
    # 1. –ú–∏—Ä ‚Üí B1.–ú–∏—Ä/ (—Ä—ã–Ω–æ–∫) + A1.–ö–æ–º–∞–Ω–¥—ã-–∏-—Å–æ–æ–±—â–µ—Å—Ç–≤–∞/ (–∫–æ–º–∞–Ω–¥—ã/—Å–æ–æ–±—â–µ—Å—Ç–≤–∞ docs)
    "1. –ú–∏—Ä (–ù–∞–¥—Å–∏—Å—Ç–µ–º–∞)/1.1. –°–º—ã—Å–ª—ã ‚Äî –ü—Ä–æ–¥–≤–∏–∂–µ–Ω–∏–µ": [
        "B.–≠–∫–æ—Å–∏—Å—Ç–µ–º–∞-—Ä–∞–∑–≤–∏—Ç–∏—è/B1.–ú–∏—Ä/B1.1.Meaning"
    ],
    "1. –ú–∏—Ä (–ù–∞–¥—Å–∏—Å—Ç–µ–º–∞)/1.2. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ ‚Äî –ö–æ–Ω—Ç–µ–∫—Å—Ç—ã –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è —Å–æ–∑–∏–¥–∞—Ç–µ–ª—è": [
        "B.–≠–∫–æ—Å–∏—Å—Ç–µ–º–∞-—Ä–∞–∑–≤–∏—Ç–∏—è/B1.–ú–∏—Ä/B1.2.Architecture"
    ],
    "1. –ú–∏—Ä (–ù–∞–¥—Å–∏—Å—Ç–µ–º–∞)/1.3. –û–ø–µ—Ä–∞—Ü–∏–∏ ‚Äî –†–µ–ø—É—Ç–∞—Ü–∏—è –∏ –ø–∞—Ä—Ç–Ω—ë—Ä—Å—Ç–≤–∞": [
        "B.–≠–∫–æ—Å–∏—Å—Ç–µ–º–∞-—Ä–∞–∑–≤–∏—Ç–∏—è/B1.–ú–∏—Ä/B1.3.Operations"
    ],
    
    # 2. –°–æ–∑–∏–¥–∞—Ç–µ–ª—å ‚Üí A2.–°–æ–∑–∏–¥–∞—Ç–µ–ª—å/
    "2. –°–æ–∑–∏–¥–∞—Ç–µ–ª—å (–¶–µ–ª–µ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞)/2.1. –°–º—ã—Å–ª—ã ‚Äî –¶–µ–Ω–Ω–æ—Å—Ç—å –∏ –±–∏–∑–Ω–µ—Å-–º–æ–¥–µ–ª–∏": [
        "A.–°–æ–∑–∏–¥–∞—Ç–µ–ª—å/A2.–°–æ–∑–∏–¥–∞—Ç–µ–ª—å/A2.1.Meaning"
    ],
    "2. –°–æ–∑–∏–¥–∞—Ç–µ–ª—å (–¶–µ–ª–µ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞)/2.2. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ ‚Äî –ú–æ–¥–µ–ª—å –∏ –∫–æ–º–ø–µ—Ç–µ–Ω—Ü–∏–∏": [
        "A.–°–æ–∑–∏–¥–∞—Ç–µ–ª—å/A2.–°–æ–∑–∏–¥–∞—Ç–µ–ª—å/A2.2.Architecture"
    ],
    "2. –°–æ–∑–∏–¥–∞—Ç–µ–ª—å (–¶–µ–ª–µ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞)/2.3. –û–ø–µ—Ä–∞—Ü–∏–∏ ‚Äî –ü—É—Ç—å –∏ —Å–æ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏–µ": [
        "A.–°–æ–∑–∏–¥–∞—Ç–µ–ª—å/A2.–°–æ–∑–∏–¥–∞—Ç–µ–ª—å/A2.3.Operations"
    ],
    
    # 3. –≠–∫–æ—Å–∏—Å—Ç–µ–º–∞ ‚Üí A3, B2, B3, C (–Ω—É–∂–µ–Ω –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤)
    # –ü–æ–∫–∞ –æ–±—â–∏–π –º–∞–ø–ø–∏–Ω–≥ - –¥–µ—Ç–∞–ª—å–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –¥–µ–ª–∞–µ—Ç—Å—è –≤—Ä—É—á–Ω—É—é
    "3. –≠–∫–æ—Å–∏—Å—Ç–µ–º–∞ —Ä–∞–∑–≤–∏—Ç–∏—è (–°–∏—Å—Ç–µ–º–∞ —Å–æ–∑–¥–∞–Ω–∏—è)/3.1. –°–º—ã—Å–ª—ã ‚Äî –≠–∫–æ–Ω–æ–º–∏–∫–∞ –∏ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏": [
        "B.–≠–∫–æ—Å–∏—Å—Ç–µ–º–∞-—Ä–∞–∑–≤–∏—Ç–∏—è/B3.–°–∏—Å—Ç–µ–º–∞-—Å–æ–∑–¥–∞–Ω–∏—è-–≠–∫–æ—Å–∏—Å—Ç–µ–º—ã/B3.1.Meaning"
    ],
    "3. –≠–∫–æ—Å–∏—Å—Ç–µ–º–∞ —Ä–∞–∑–≤–∏—Ç–∏—è (–°–∏—Å—Ç–µ–º–∞ —Å–æ–∑–¥–∞–Ω–∏—è)/3.2. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ ‚Äî –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ –∏ –ø–æ–¥—Å–∏—Å—Ç–µ–º—ã": [
        "B.–≠–∫–æ—Å–∏—Å—Ç–µ–º–∞-—Ä–∞–∑–≤–∏—Ç–∏—è/B2.–≠–∫–æ—Å–∏—Å—Ç–µ–º–∞-—Ä–∞–∑–≤–∏—Ç–∏—è/B2.2.Architecture",
        "C.–ò–¢-–ø–ª–∞—Ç—Ñ–æ—Ä–º–∞-–≠–∫–æ—Å–∏—Å—Ç–µ–º—ã/C2.–ò–¢-–ø–ª–∞—Ç—Ñ–æ—Ä–º–∞-–≠–∫–æ—Å–∏—Å—Ç–µ–º—ã/C2.2.Architecture"
    ],
    "3. –≠–∫–æ—Å–∏—Å—Ç–µ–º–∞ —Ä–∞–∑–≤–∏—Ç–∏—è (–°–∏—Å—Ç–µ–º–∞ —Å–æ–∑–¥–∞–Ω–∏—è)/3.3. –û–ø–µ—Ä–∞—Ü–∏–∏ ‚Äî –ö–æ–º–∞–Ω–¥–∞ –∏ —Å–ª—É–∂–±—ã": [
        "B.–≠–∫–æ—Å–∏—Å—Ç–µ–º–∞-—Ä–∞–∑–≤–∏—Ç–∏—è/B3.–°–∏—Å—Ç–µ–º–∞-—Å–æ–∑–¥–∞–Ω–∏—è-–≠–∫–æ—Å–∏—Å—Ç–µ–º—ã/B3.3.Operations",
        "C.–ò–¢-–ø–ª–∞—Ç—Ñ–æ—Ä–º–∞-–≠–∫–æ—Å–∏—Å—Ç–µ–º—ã/C3.–ò–¢-—Å–ª—É–∂–±–∞/C3.3.Operations"
    ],
}


def copy_directory(src: Path, dest: Path, skip_existing: bool = True):
    """–ö–æ–ø–∏—Ä—É–µ—Ç —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏"""
    if not src.exists():
        print(f"‚ö†Ô∏è  –ò—Å—Ç–æ—á–Ω–∏–∫ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç: {src}")
        return
    
    dest.mkdir(parents=True, exist_ok=True)
    
    for item in src.iterdir():
        dest_item = dest / item.name
        
        if item.is_file():
            if skip_existing and dest_item.exists():
                print(f"‚è≠Ô∏è  –ü—Ä–æ–ø—É—Å–∫–∞–µ–º (—É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç): {dest_item}")
            else:
                shutil.copy2(item, dest_item)
                print(f"‚úÖ –°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ: {item.name} ‚Üí {dest_item}")
        elif item.is_dir():
            copy_directory(item, dest_item, skip_existing)


def migrate_content():
    """–û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –º–∏–≥—Ä–∞—Ü–∏–∏"""
    print("=" * 80)
    print("–ú–∏–≥—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞ old/content/ ‚Üí –Ω–æ–≤–∞—è S2R —Å—Ç—Ä—É–∫—Ç—É—Ä–∞")
    print("=" * 80)
    
    total_mapped = 0
    total_copied = 0
    
    for old_path_str, new_paths_list in MAPPING.items():
        old_path = OLD_CONTENT / old_path_str
        
        if not old_path.exists():
            print(f"\n‚ö†Ô∏è  –ü–†–û–ü–£–°–ö–ê–ï–ú (–Ω–µ—Ç –≤ old/): {old_path_str}")
            continue
        
        print(f"\nüìÅ –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º: {old_path_str}")
        print(f"   ‚Üí –¶–µ–ª–µ–π: {len(new_paths_list)}")
        
        for new_path_str in new_paths_list:
            new_path = REPO_ROOT / new_path_str
            print(f"\n   –ö–æ–ø–∏—Ä—É–µ–º –≤: {new_path_str}")
            
            # –ö–æ–ø–∏—Ä—É–µ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ (–Ω–µ —Å–∞–º—É –ø–∞–ø–∫—É)
            copy_directory(old_path, new_path, skip_existing=True)
            total_mapped += 1
    
    print("\n" + "=" * 80)
    print(f"‚úÖ –ú–∏–≥—Ä–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞!")
    print(f"   –û–±—Ä–∞–±–æ—Ç–∞–Ω–æ –º–∞–ø–ø–∏–Ω–≥–æ–≤: {total_mapped}")
    print("=" * 80)
    print("\nüìù –°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò:")
    print("1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –Ω–æ–≤—ã—Ö –ø–∞–ø–æ–∫")
    print("2. –î–æ–∫—É–º–µ–Ω—Ç—ã –∏–∑ 3. –≠–∫–æ—Å–∏—Å—Ç–µ–º–∞ —Ç—Ä–µ–±—É—é—Ç —Ä—É—á–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É")
    print("3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Å—ã–ª–æ–∫")


if __name__ == "__main__":
    migrate_content()
