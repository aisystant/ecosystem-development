---

type: doc
status: active
created: 2025-12-19
layer: methodology
scope: local-edge
ai_role: feature
target_audience:
  - контрибьюторы
  - команда экосистемы
aliases:
  - Claude Code
  - Claude Code и FPF
  - Работа с Claude Code
depends_on:
  - "[[Процессы работы с хранилищем 0.2]]"
related:
  - "[[FPF-Spec]]"
---

# Claude Code и FPF 0.2

## 0. Назначение документа

Этот документ описывает техническую сторону работы Claude Code с интегрированным First Principles Framework (FPF) — как устроен контекст, расход токенов и стратегии их экономии при работе с хранилищем экосистемы.

---

## 1. Как работает Claude Code

### Что получает Claude при каждом запросе

```
┌─────────────────────────────────────────────────────────────┐
│ 1. Системный промпт Claude Code                             │
│    - Инструкции по использованию инструментов              │
│    - Правила работы с git, файлами, кодом                  │
│    - Ограничения безопасности                              │
├─────────────────────────────────────────────────────────────┤
│ 2. CLAUDE.md (автоматически)                                │
│    - Контекст проекта: ecosystem-development               │
│    - FPF: 5 ключевых принципов + цикл рассуждения          │
│    - Терминология: Созидатель, Экзокортекс и т.д.          │
├─────────────────────────────────────────────────────────────┤
│ 3. История диалога                                          │
│    - Все предыдущие сообщения текущей сессии               │
│    - Результаты вызовов инструментов                       │
├─────────────────────────────────────────────────────────────┤
│ 4. Ваш текущий запрос                                       │
└─────────────────────────────────────────────────────────────┘
```

### Как используется CLAUDE.md

1. **Терминология** — когда вы говорите "созидатель", Claude понимает это как "целевая система — человек, которого развивает экосистема", а не абстрактное слово

2. **FPF-принципы** — при рассуждениях Claude держит в уме:
   - Holonic: всё одновременно целое и часть
   - Bounded Context: значение локально
   - Strict Distinction: роль ≠ метод ≠ работа

3. **Цикл ADI** — при сложных задачах:
   - Abduction: генерировать 2-3 гипотезы
   - Deduction: проверить логику
   - Induction: собрать evidence

4. **Ссылка на полный FPF** — Claude знает, что `.fpf/FPF-Spec.md` содержит полную спецификацию, но не загружает её автоматически (экономия токенов)

### Что НЕ загружается автоматически

- Полный FPF-Spec.md (~800K токенов) — только по запросу
- Содержимое файлов проекта — читается когда нужно для задачи
- История git — запрашивается при необходимости

### Практический пример

Когда вы просите "добавь FPF в название документа":
1. Claude уже знает из CLAUDE.md, что FPF = First Principles Framework
2. Понимает контекст проекта без дополнительных вопросов
3. Использует инструменты (Read, Edit, Bash) для выполнения
4. Следует стилю документов хранилища (frontmatter, wikilinks)

---

## 2. Расход токенов

### Конфигурация проекта

| Компонент | Токены | Когда загружается |
|-----------|--------|-------------------|
| CLAUDE.md | ~1,000 | Каждый запрос |
| FPF-Spec.md (полный) | ~800,000 | Только по запросу |
| Обычный файл проекта | ~500-2,000 | Когда Claude его читает |
| Ваш запрос | ~50-200 | Каждый запрос |
| Ответ Claude | ~200-2,000 | Каждый запрос |

### Типичные сценарии

**Простой запрос** (без загрузки файлов):

```
Вы: "Какие роли есть у созидателя?"

Расход: ~3K токенов (CLAUDE.md + запрос + ответ)
```

**Работа с файлами**:

```
Вы: "Прочитай content/2. Созидатель/2.2. Архитектура/README.md
     и предложи улучшения"

Расход: ~5-10K токенов (CLAUDE.md + файл + запрос + ответ)
```

**Загрузка полного FPF** (редко нужно):

```
Вы: "Загрузи .fpf/FPF-Spec.md и объясни Part B"

Расход: ~850K токенов (почти весь контекст!)
```

---

## 3. Стратегия экономии токенов

### Архитектура контекста

```
CLAUDE.md (~1K токенов)          ← загружается ВСЕГДА
    │
    └── Содержит:
        • Краткие принципы FPF (5 пунктов)
        • Терминологию проекта
        • Ссылку на полный FPF

.fpf/FPF-Spec.md (~800K токенов) ← загружается ПО ЗАПРОСУ
    │
    └── Полная спецификация для сложных задач
```

### Рекомендации по использованию

| Задача | Что делать | Токены |
|--------|------------|--------|
| Обычная работа | Просто пишите запрос, CLAUDE.md хватит | ~3-5K |
| Нужна конкретная часть FPF | "Прочитай Part B из .fpf/FPF-Spec.md" | ~50-100K |
| Глубокий анализ по FPF | "Загрузи весь FPF-Spec.md" | ~850K |

---

## 4. Автоматическая навигация по FPF

Claude Code автоматически загружает нужные части FPF в зависимости от задачи благодаря индексу `.fpf/INDEX.md`.

### Карта частей FPF-Spec.md

| Часть | Строки | Описание | Когда загружать |
|-------|--------|----------|-----------------|
| **Table of Content** | 1-294 | Оглавление | Обзор структуры |
| **Part A** | 625-11835 | Kernel Architecture | Анализ ролей, систем |
| **Part B** | 11836-15989 | Reasoning | Рассуждения, Trust Calculus |
| **Part C** | 15990-22614 | Architheories | Формальные спецификации |
| **Part D** | 22615-22751 | Ethics | Этические вопросы |
| **Part E** | 22752-28801 | Constitution | Принципы FPF |
| **Part F** | 28802-35429 | Unification Suite | Терминология, мосты |
| **Part G** | 35430-37919 | SoTA Kit | Работа с SoTA-методами |

### Как это работает

1. Claude видит таблицу навигации в CLAUDE.md
2. По типу задачи определяет нужную часть FPF
3. Читает FPF-Spec.md с нужным `offset` и `limit`

**Пример:** для задачи про роли Claude загрузит Part A:
```
Read .fpf/FPF-Spec.md offset=625 limit=11000
```

---

## 5. Лимиты контекста

| Модель | Контекст | Ограничения |
|--------|----------|-------------|
| Claude Sonnet | 200K токенов | FPF не влезет целиком |
| Claude Opus | 200K токенов | FPF не влезет целиком |

**Практические выводы:**

- Полный FPF (~800K) не влезает в контекст ни одной модели
- Для обычной работы хватает CLAUDE.md
- Для сложных задач — запрашивайте конкретную часть (Part A, Part B и т.д.)

---

## 6. Типичный расход

В обычном режиме работы: **3-10K токенов за запрос**.

Это эффективно для большинства задач. CLAUDE.md даёт достаточно контекста без перегрузки.

---

## 7. Обновление FPF

FPF развивается, периодически выходят новые версии. Рекомендуется обновлять раз в месяц или при выходе новой версии.

### Windows (PowerShell)

```powershell
cd C:\ecosystem-development
Invoke-WebRequest -Uri "https://raw.githubusercontent.com/ailev/FPF/main/FPF-Spec.md" -OutFile ".fpf\FPF-Spec.md"
git add .fpf
git commit -m "chore: update FPF"
git push
```

### Mac / Linux (Terminal)

```bash
cd ~/ecosystem-development
curl -fsSL https://raw.githubusercontent.com/ailev/FPF/main/FPF-Spec.md -o .fpf/FPF-Spec.md
git add .fpf
git commit -m "chore: update FPF"
git push
```

### Проверка версии

Откройте `.fpf/FPF-Spec.md` и найдите строку `Version:` в начале файла.

---

## 8. Связанные документы

**Зависит от (depends_on):**

- [[Процессы работы с хранилищем 0.2]] — общие процессы работы с хранилищем

**Связанные (related):**

- [[FPF-Spec]] — полная спецификация First Principles Framework
- [[CLAUDE.md]] — инструкции для Claude Code с интегрированным FPF
- [[INDEX.md]] — навигационный индекс по частям FPF
