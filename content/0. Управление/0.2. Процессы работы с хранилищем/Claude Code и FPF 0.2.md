---

type: doc
status: active
created: 2025-12-19
layer: methodology
scope: local-edge
ai_role: feature
target_audience:
  - контрибьюторы
  - команда экосистемы
aliases:
  - Claude Code
  - Claude Code и FPF
  - Работа с Claude Code
depends_on:
  - "[[Процессы работы с хранилищем 0.2]]"
related:
  - "[[FPF-Spec]]"
---

# Claude Code и FPF 0.2

## 0. Назначение документа

Этот документ описывает техническую сторону работы Claude Code с интегрированным First Principles Framework (FPF) — как устроен контекст, расход токенов и стратегии их экономии при работе с хранилищем экосистемы.

---

## 1. Как работает Claude Code

### Что происходит при каждом запросе

```
Ваш запрос: "Создай файл для роли Ученика"

Что отправляется в Claude:
┌─────────────────────────────────────────┐
│ 1. Системный промпт Claude Code         │  ~2K токенов
│ 2. Содержимое CLAUDE.md                 │  ~1K токенов
│ 3. История диалога                      │  ~XK токенов (растёт)
│ 4. Ваш запрос                           │  ~50 токенов
│ 5. (если нужно) содержимое файлов       │  ~YK токенов
└─────────────────────────────────────────┘
```

### Ключевые компоненты

| Компонент | Описание |
|-----------|----------|
| **Системный промпт** | Встроенные инструкции Claude Code |
| **CLAUDE.md** | Проектные инструкции с интегрированным FPF: ключевые принципы First Principles Framework, терминология проекта, ссылка на полную спецификацию. Загружается автоматически при каждом запросе |
| **История диалога** | Все предыдущие сообщения сессии |
| **Контент файлов** | Файлы, которые Claude читает по запросу |

---

## 2. Расход токенов

### Конфигурация проекта

| Компонент | Токены | Когда загружается |
|-----------|--------|-------------------|
| CLAUDE.md | ~1,000 | Каждый запрос |
| FPF-Spec.md (полный) | ~800,000 | Только по запросу |
| Обычный файл проекта | ~500-2,000 | Когда Claude его читает |
| Ваш запрос | ~50-200 | Каждый запрос |
| Ответ Claude | ~200-2,000 | Каждый запрос |

### Типичные сценарии

**Простой запрос** (без загрузки файлов):

```
Вы: "Какие роли есть у созидателя?"

Расход: ~3K токенов (CLAUDE.md + запрос + ответ)
```

**Работа с файлами**:

```
Вы: "Прочитай content/2. Созидатель/2.2. Архитектура/README.md
     и предложи улучшения"

Расход: ~5-10K токенов (CLAUDE.md + файл + запрос + ответ)
```

**Загрузка полного FPF** (редко нужно):

```
Вы: "Загрузи .fpf/FPF-Spec.md и объясни Part B"

Расход: ~850K токенов (почти весь контекст!)
```

---

## 3. Стратегия экономии токенов

### Архитектура контекста

```
CLAUDE.md (~1K токенов)          ← загружается ВСЕГДА
    │
    └── Содержит:
        • Краткие принципы FPF (5 пунктов)
        • Терминологию проекта
        • Ссылку на полный FPF

.fpf/FPF-Spec.md (~800K токенов) ← загружается ПО ЗАПРОСУ
    │
    └── Полная спецификация для сложных задач
```

### Рекомендации по использованию

| Задача | Что делать | Токены |
|--------|------------|--------|
| Обычная работа | Просто пишите запрос, CLAUDE.md хватит | ~3-5K |
| Нужна конкретная часть FPF | "Прочитай Part B из .fpf/FPF-Spec.md" | ~50-100K |
| Глубокий анализ по FPF | "Загрузи весь FPF-Spec.md" | ~850K |

---

## 4. Лимиты контекста

| Модель | Контекст | Ограничения |
|--------|----------|-------------|
| Claude Sonnet | 200K токенов | FPF не влезет целиком |
| Claude Opus | 200K токенов | FPF не влезет целиком |

**Практические выводы:**

- Полный FPF (~800K) не влезает в контекст ни одной модели
- Для обычной работы хватает CLAUDE.md
- Для сложных задач — запрашивайте конкретную часть (Part A, Part B и т.д.)

---

## 5. Типичный расход

В обычном режиме работы: **3-10K токенов за запрос**.

Это эффективно для большинства задач. CLAUDE.md даёт достаточно контекста без перегрузки.

---

## 6. Обновление FPF

FPF развивается, периодически выходят новые версии. Рекомендуется обновлять раз в месяц или при выходе новой версии.

### Windows (PowerShell)

```powershell
cd C:\ecosystem-development
Invoke-WebRequest -Uri "https://raw.githubusercontent.com/ailev/FPF/main/FPF-Spec.md" -OutFile ".fpf\FPF-Spec.md"
git add .fpf
git commit -m "chore: update FPF"
git push
```

### Mac / Linux (Terminal)

```bash
cd ~/ecosystem-development
curl -fsSL https://raw.githubusercontent.com/ailev/FPF/main/FPF-Spec.md -o .fpf/FPF-Spec.md
git add .fpf
git commit -m "chore: update FPF"
git push
```

### Проверка версии

Откройте `.fpf/FPF-Spec.md` и найдите строку `Version:` в начале файла.

---

## 7. Связанные документы

**Зависит от (depends_on):**

- [[Процессы работы с хранилищем 0.2]] — общие процессы работы с хранилищем

**Связанные (related):**

- [[FPF-Spec]] — полная спецификация First Principles Framework
- [[CLAUDE.md]] — инструкции для Claude Code с интегрированным FPF
