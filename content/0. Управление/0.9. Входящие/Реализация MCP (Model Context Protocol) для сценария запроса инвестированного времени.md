–°—Ü–µ–Ω–∞—Ä–∏–π:

> üí¨ –ß–µ–ª–æ–≤–µ–∫ —Å–ø—Ä–∞—à–∏–≤–∞–µ—Ç –ü—Ä–æ–≤–æ–¥–Ω–∏–∫–∞:  
> _¬´–°–∫–æ–ª—å–∫–æ —è –∏–Ω–≤–µ—Å—Ç–∏—Ä–æ–≤–∞–ª –≤—Ä–µ–º–µ–Ω–∏ –∑–∞ –Ω–µ–¥–µ–ª—é –∏ –≤ —Å—Ä–µ–¥–Ω–µ–º –∑–∞ –¥–µ–Ω—å?¬ª_

---

## üéØ –¶–µ–ª—å

–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å JSON-RPC –º–µ—Ç–æ–¥ MCP `get_invested_time`,  
–∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä –ø–µ—Ä–∏–æ–¥–∞ (`week`, `month`, `day` –∏ —Ç.–¥.)  
–∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç:
- –æ–±—â–µ–µ –≤—Ä–µ–º—è –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–π –∑–∞ –ø–µ—Ä–∏–æ–¥,    
- —Å—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –∑–∞ –¥–µ–Ω—å.
    

---

# –ö—Ä–∞—Ç–∫–∞—è –≤–µ—Ä—Å–∏—è
## üß© 1. JSON-RPC —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∑–∞–ø—Ä–æ—Å–∞ –∏ –æ—Ç–≤–µ—Ç–∞

**–ó–∞–ø—Ä–æ—Å –æ—Ç –ê—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞ –∫ MCP:**

```json
{
  "jsonrpc": "2.0",
  "method": "get_invested_time",
  "params": {
    "period": "week"
  }
}
```

**–û—Ç–≤–µ—Ç –æ—Ç MCP:**

```json
{
  "jsonrpc": "2.0",
  "result": {
    "period": "week",
    "total_hours": 9.8,
    "average_per_day": 1.4,
    "start_date": "2025-12-15",
    "end_date": "2025-12-21"
  }
}
```

---

## ‚öôÔ∏è 2. –ü—Ä–∏–º–µ—Ä —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ MCP-—Å–µ—Ä–≤–µ—Ä–∞ (–Ω–∞ Python / FastAPI)

–≠—Ç–æ—Ç –ø—Ä–∏–º–µ—Ä –º–æ–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ `digital-twin-mcp.aisystant.workers.dev/mcp`.

```python
from fastapi import FastAPI, Request
from datetime import datetime, timedelta
import json

app = FastAPI()

# –ü—Ä–∏–º–µ—Ä–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –≤–∞—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö –æ –¥–µ–π—Å—Ç–≤–∏—è—Ö
activity_log = [
    {"timestamp": "2025-12-15T10:00:00", "duration_minutes": 60},
    {"timestamp": "2025-12-16T09:30:00", "duration_minutes": 40},
    {"timestamp": "2025-12-17T19:00:00", "duration_minutes": 80},
    {"timestamp": "2025-12-19T20:00:00", "duration_minutes": 60},
    {"timestamp": "2025-12-21T10:00:00", "duration_minutes": 50}
]

@app.post("/mcp")
async def mcp_endpoint(request: Request):
    body = await request.json()
    method = body.get("method")
    params = body.get("params", {})

    if method == "get_invested_time":
        return await get_invested_time(params)
    else:
        return {"jsonrpc": "2.0", "error": {"code": -32601, "message": "Method not found"}}

async def get_invested_time(params):
    period = params.get("period", "week")
    now = datetime.utcnow()
    
    # –û–ø—Ä–µ–¥–µ–ª—è–µ–º –Ω–∞—á–∞–ª–æ –Ω–µ–¥–µ–ª–∏
    if period == "week":
        start = now - timedelta(days=7)
    elif period == "month":
        start = now - timedelta(days=30)
    else:
        start = now - timedelta(days=1)

    # –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ª–æ–≥–æ–≤ –ø–æ –ø–µ—Ä–∏–æ–¥—É
    sessions = [a for a in activity_log if datetime.fromisoformat(a["timestamp"]) >= start]

    total_minutes = sum(a["duration_minutes"] for a in sessions)
    total_hours = round(total_minutes / 60, 2)

    days = max(1, (now - start).days)
    average_per_day = round(total_hours / days, 2)

    return {
        "jsonrpc": "2.0",
        "result": {
            "period": period,
            "total_hours": total_hours,
            "average_per_day": average_per_day,
            "start_date": start.strftime("%Y-%m-%d"),
            "end_date": now.strftime("%Y-%m-%d")
        }
    }
```

---

## üß† 3. –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ

**1Ô∏è‚É£ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:**

> ¬´–ü—Ä–æ–≤–æ–¥–Ω–∏–∫, —Å–∫–æ–ª—å–∫–æ —è –∏–Ω–≤–µ—Å—Ç–∏—Ä–æ–≤–∞–ª –≤—Ä–µ–º–µ–Ω–∏ –∑–∞ –Ω–µ–¥–µ–ª—é –∏ –≤ —Å—Ä–µ–¥–Ω–µ–º –∑–∞ –¥–µ–Ω—å?¬ª

**2Ô∏è‚É£ –ê—Å—Å–∏—Å—Ç–µ–Ω—Ç:**  
–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç JSON-RPC –∑–∞–ø—Ä–æ—Å:

```json
{"jsonrpc":"2.0","method":"get_invested_time","params":{"period":"week"}}
```

**3Ô∏è‚É£ MCP –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç:**

```json
{"jsonrpc":"2.0","result":{"total_hours":9.8,"average_per_day":1.4}}
```

**4Ô∏è‚É£ –ê—Å—Å–∏—Å—Ç–µ–Ω—Ç –æ—Ç–≤–µ—á–∞–µ—Ç —á–µ–ª–æ–≤–µ–∫—É:**

> ¬´–ó–∞ –ø—Ä–æ—à–µ–¥—à—É—é –Ω–µ–¥–µ–ª—é –≤—ã –∏–Ω–≤–µ—Å—Ç–∏—Ä–æ–≤–∞–ª–∏ 9,8 —á–∞—Å–æ–≤ ‚Äî –≤ —Å—Ä–µ–¥–Ω–µ–º –ø–æ 1 —á–∞—Å 24 –º–∏–Ω—É—Ç—ã –≤ –¥–µ–Ω—å.¬ª

---

## üí¨ 4. –†–∞—Å—à–∏—Ä–µ–Ω–∏—è (–ø–æ –∂–µ–ª–∞–Ω–∏—é)

- –¥–æ–±–∞–≤–∏—Ç—å `period: "month"` –∏–ª–∏ `custom_start/custom_end` –¥–ª—è –≥–∏–±–∫–æ—Å—Ç–∏;
    
- –ø–æ–∑–≤–æ–ª–∏—Ç—å MCP –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å —Ç–∞–∫–∂–µ **—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ –¥–Ω—è–º**;
    
- –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å —ç—Ç–æ—Ç –≤—ã–∑–æ–≤ –≤ –∏—Å—Ç–æ—Ä–∏–∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è.
    

---


# –í–µ—Ä—Å–∏—è –ø–æ –∫–∞–Ω–æ–Ω–∏—á–µ—Å–∫–æ–º—É —à–∞–±–ª–æ–Ω—É

–í–æ—Ç –≥–æ—Ç–æ–≤—ã–π –¥–æ–∫—É–º–µ–Ω—Ç –≤ –∫–∞–Ω–æ–Ω–∏—á–µ—Å–∫–æ–º —Ñ–æ—Ä–º–∞—Ç–µ ‚Äî **–æ–ø–∏—Å–∞–Ω–∏–µ MCP-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞**  
`dt.get_time_invested_summary v1`  
–¥–ª—è –≤–∞—à–µ–π —Å–∏—Å—Ç–µ–º—ã **–¶–∏—Ñ—Ä–æ–≤–æ–≥–æ –¥–≤–æ–π–Ω–∏–∫–∞ (Digital Twin)**.

---
## 0) –ó–∞–≥–æ–ª–æ–≤–æ–∫

**Tool name:** `dt.get_time_invested_summary`  
**–ü–æ–¥—Å–∏—Å—Ç–µ–º–∞-–≤–ª–∞–¥–µ–ª–µ—Ü:** –¶–∏—Ñ—Ä–æ–≤–æ–π –¥–≤–æ–π–Ω–∏–∫ (Digital Twin)  
**–°—Ç–∞—Ç—É—Å:** `stable`  
**–í–µ—Ä—Å–∏—è –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞:** `v1.0`  
**–î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:** `2025-12-21`  
**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π:** –ö–æ–º–∞–Ω–¥–∞ ¬´–ü—Ä–æ–≤–æ–¥–Ω–∏–∫ / –ê—Å—Å–∏—Å—Ç–µ–Ω—Ç –£—á–µ–Ω–∏–∫–∞¬ª  
**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**

- `dt://catalogs/metrics` (–∫–∞—Ç–∞–ª–æ–≥ –º–µ—Ç—Ä–∏–∫)
    
- `dt://schemas/activity_event` (—Å—Ö–µ–º–∞ —Å–æ–±—ã—Ç–∏–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏)
    
- `dt://policies/data_quality` (–ø—Ä–∞–≤–∏–ª–∞ –æ—Ü–µ–Ω–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –¥–∞–Ω–Ω—ã—Ö)
    

---

## 1) –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ (Intent)

–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ **–∏–Ω–≤–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏** –∑–∞ —É–∫–∞–∑–∞–Ω–Ω—ã–π –ø–µ—Ä–∏–æ–¥ –∏–∑ –±–∞–∑—ã –¶–∏—Ñ—Ä–æ–≤–æ–≥–æ –î–≤–æ–π–Ω–∏–∫–∞:

- –æ–±—â–µ–µ –≤—Ä–µ–º—è (total_minutes / total_hours),
    
- —Å—Ä–µ–¥–Ω–µ–µ –∑–∞ –¥–µ–Ω—å,
    
- —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ –¥–∞—Ç–∞–º,
    
- –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –∫–∞—á–µ—Å—Ç–≤–∞ –¥–∞–Ω–Ω—ã—Ö (coverage, sources, last_sync).
    

---

## 2) –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å / –∫–æ–≥–¥–∞ –ù–ï –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

**Use when:**

- –Ω—É–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å —Å–≤–æ–¥–∫—É –ø–æ –≤—Ä–µ–º–µ–Ω–∏ —Å–∞–º–æ—Ä–∞–∑–≤–∏—Ç–∏—è –∏–ª–∏ –ø—Ä–æ–µ–∫—Ç–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∑–∞ –ø–µ—Ä–∏–æ–¥;
    
- —Ç—Ä–µ–±—É–µ—Ç—Å—è –æ—Ü–µ–Ω–∏—Ç—å —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å —Ä–∏—Ç–º–∞ –ø—Ä–∞–∫—Ç–∏–∫–∏ (¬´–Ω–∞–ª—ë—Ç —á–∞—Å–æ–≤¬ª, —Å—Ä–µ–¥–Ω–µ–µ –∑–∞ –¥–µ–Ω—å);
    
- —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è –æ—Ç—á—ë—Ç –∏–ª–∏ –∫–∞—Ä—Ç–æ—á–∫–∞ –∞–Ω–∞–ª–∏–∑–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞.
    

**Do NOT use when:**

- –Ω—É–∂–µ–Ω —Å–ø–∏—Å–æ–∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π –∏–ª–∏ —Å–µ—Å—Å–∏–π ‚Äî —Å–º. `dt.list_activity_events`;
    
- —Ç—Ä–µ–±—É–µ—Ç—Å—è –∞–Ω–∞–ª–∏–∑ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ (–∫–∞—á–µ—Å—Ç–≤–æ, —Å–º—ã—Å–ª–æ–≤–æ–µ –Ω–∞–ø–æ–ª–Ω–µ–Ω–∏–µ) ‚Äî —Å–º. `dt.get_learning_efficiency`;
    
- –ø–µ—Ä–∏–æ–¥ –Ω–µ–ø–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞–∫—Ä—ã—Ç –¥–∞–Ω–Ω—ã–º–∏ ‚Äî —Å–Ω–∞—á–∞–ª–∞ –≤—ã–∑–≤–∞—Ç—å `dt.get_data_coverage`.
    

---

## 3) –ö–æ–Ω—Ç—Ä–∞–∫—Ç –≤—ã–∑–æ–≤–∞

### 3.1 Input schema

```json
{
  "type": "object",
  "required": ["start_date", "end_date", "timezone"],
  "properties": {
    "start_date": {
      "type": "string",
      "description": "–ù–∞—á–∞–ª–æ –ø–µ—Ä–∏–æ–¥–∞ (–≤–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ) –≤ —Ñ–æ—Ä–º–∞—Ç–µ YYYY-MM-DD."
    },
    "end_date": {
      "type": "string",
      "description": "–ö–æ–Ω–µ—Ü –ø–µ—Ä–∏–æ–¥–∞ (–≤–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ) –≤ —Ñ–æ—Ä–º–∞—Ç–µ YYYY-MM-DD."
    },
    "timezone": {
      "type": "string",
      "description": "IANA timezone, –Ω–∞–ø—Ä–∏–º–µ—Ä Europe/Moscow."
    },
    "granularity": {
      "type": "string",
      "enum": ["none", "day", "week"],
      "default": "day",
      "description": "–î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è –≤—ã–¥–∞—á–∏ –ø–æ –ø–æ–¥-–ø–µ—Ä–∏–æ–¥–∞–º."
    },
    "filters": {
      "type": "object",
      "description": "–§–∏–ª—å—Ç—Ä—ã –ø–æ —Ç–∏–ø–∞–º –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∏–ª–∏ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º.",
      "properties": {
        "activity_type": {
          "type": "string",
          "description": "–¢–∏–ø –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏: learning, project, reading –∏ —Ç.–¥."
        },
        "sources": {
          "type": "array",
          "items": { "type": "string" },
          "description": "–ò—Å—Ç–æ—á–Ω–∏–∫–∏ –¥–∞–Ω–Ω—ã—Ö: timer, manual_log, calendar."
        }
      },
      "additionalProperties": false
    }
  },
  "additionalProperties": false
}
```

---

### 3.2 Output schema

```json
{
  "period": {
    "start_date": "YYYY-MM-DD",
    "end_date": "YYYY-MM-DD",
    "timezone": "IANA"
  },
  "total_minutes": 0,
  "avg_minutes_per_day": 0,
  "breakdown": [
    { "date": "YYYY-MM-DD", "minutes": 0 }
  ],
  "data_quality": {
    "coverage_ratio": 0.0,
    "sources": ["timer", "manual_log"],
    "last_sync_at": "ISO-8601",
    "notes": "–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π, –µ—Å–ª–∏ –µ—Å—Ç—å –Ω–µ–ø–æ–ª–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ."
  }
}
```

---

## 4) –°–µ–º–∞–Ω—Ç–∏–∫–∞ –¥–∞–Ω–Ω—ã—Ö

**–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫–∏:**  
¬´–ò–Ω–≤–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è¬ª ‚Äî —Å—É–º–º–∞—Ä–Ω–∞—è –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–µ–π, –ø–æ–º–µ—á–µ–Ω–Ω—ã—Ö –∫–∞–∫ `learning`, `reading`, `project_work`, `reflection`.  
–ù–µ –≤–∫–ª—é—á–∞—é—Ç—Å—è –ø–µ—Ä–∏–æ–¥—ã –±–µ–∑–¥–µ–π—Å—Ç–≤–∏—è (`idle`), –¥–æ—Ä–æ–≥–∞, —Å–æ–Ω, –ø–∞—É–∑—ã.

**–ï–¥–∏–Ω–∏—Ü—ã:** –º–∏–Ω—É—Ç—ã (—Ü–µ–ª–æ–µ —á–∏—Å–ª–æ).  
**–ì—Ä–∞–Ω–∏—Ü—ã –ø–µ—Ä–∏–æ–¥–∞:** –≤–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ `start_date` –∏ `end_date`, —Å —É—á—ë—Ç–æ–º `timezone`.  
**–ö–æ–Ω—Ñ–ª–∏–∫—Ç—ã –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤:** –µ—Å–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ —Ñ–∏–∫—Å–∏—Ä—É—é—Ç –æ–¥–Ω—É –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç: `timer` ‚Üí `manual_log` ‚Üí `calendar`.

---

## 5) –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –∫–∞—á–µ—Å—Ç–≤–∞ –¥–∞–Ω–Ω—ã—Ö

- `coverage_ratio` ‚Äî –¥–æ–ª—è –ø–æ–ª–Ω–æ—Ç—ã –¥–∞–Ω–Ω—ã—Ö –∑–∞ –ø–µ—Ä–∏–æ–¥ (0.0‚Äì1.0).
    
- `last_sync_at` ‚Äî –º–æ–º–µ–Ω—Ç –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏.
    
- `sources` ‚Äî —Ä–µ–∞–ª—å–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –¥–∞–Ω–Ω—ã—Ö, —É—á–∞—Å—Ç–≤–æ–≤–∞–≤—à–∏–µ –≤ —Ä–∞—Å—á—ë—Ç–µ.
    
- `notes` ‚Äî –ø–æ—è—Å–Ω–µ–Ω–∏–µ –ø—Ä–∏—á–∏–Ω –Ω–∏–∑–∫–æ–≥–æ –ø–æ–∫—Ä—ã—Ç–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–Ω–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω –∫–∞–ª–µ–Ω–¥–∞—Ä—å").
    

---

## 6) –û—à–∏–±–∫–∏ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è

**–í–∞–ª–∏–¥–∞—Ü–∏—è –¥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:**

- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∞ –¥–∞—Ç –∏ timezone;
    
- `start_date ‚â§ end_date`;
    
- –ü–µ—Ä–∏–æ–¥ –Ω–µ –¥–ª–∏–Ω–Ω–µ–µ 366 –¥–Ω–µ–π;
    
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ —Ñ–∏–ª—å—Ç—Ä–æ–≤.
    

**–ö–æ–¥—ã –æ—à–∏–±–æ–∫:**

|–ö–æ–¥|–û–ø–∏—Å–∞–Ω–∏–µ|
|---|---|
|`INVALID_ARGUMENT`|–û—à–∏–±–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∞ –≤—Ö–æ–¥–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤|
|`NO_DATA`|–ù–µ—Ç –Ω–∞–±–ª—é–¥–µ–Ω–∏–π –∑–∞ –ø–µ—Ä–∏–æ–¥|
|`PARTIAL_DATA`|–î–∞–Ω–Ω—ã—Ö –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ (coverage_ratio < 0.8)|
|`UNAUTHORIZED`|–ù–µ—Ç –ø—Ä–∞–≤ –Ω–∞ –∑–∞–ø—Ä–æ—Å|
|`INTERNAL`|–í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞|

---

## 7) –ü—Ä–∏–º–µ—Ä—ã

### –ü—Ä–∏–º–µ—Ä A ‚Äî –°–≤–æ–¥–∫–∞ –∑–∞ –ø—Ä–æ—à–ª—É—é –Ω–µ–¥–µ–ª—é

**User intent:**  
¬´–°–∫–æ–ª—å–∫–æ —è –∏–Ω–≤–µ—Å—Ç–∏—Ä–æ–≤–∞–ª –≤—Ä–µ–º–µ–Ω–∏ –∑–∞ –Ω–µ–¥–µ–ª—é –∏ –≤ —Å—Ä–µ–¥–Ω–µ–º –∑–∞ –¥–µ–Ω—å?¬ª

**–í—ã–∑–æ–≤:**

```json
{
  "start_date": "2025-12-15",
  "end_date": "2025-12-21",
  "timezone": "Europe/Moscow"
}
```

**–û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç:**

```json
{
  "period": { "start_date": "2025-12-15", "end_date": "2025-12-21", "timezone": "Europe/Moscow" },
  "total_minutes": 590,
  "avg_minutes_per_day": 84,
  "breakdown": [
    { "date": "2025-12-15", "minutes": 120 },
    { "date": "2025-12-16", "minutes": 60 }
  ],
  "data_quality": {
    "coverage_ratio": 0.92,
    "sources": ["manual_log", "calendar"],
    "last_sync_at": "2025-12-21T23:59:00Z"
  }
}
```

---

### –ü—Ä–∏–º–µ—Ä B ‚Äî –¢–æ–ª—å–∫–æ learning –ø–æ –¥–∞–Ω–Ω—ã–º —Ç–∞–π–º–µ—Ä–∞

**–í—ã–∑–æ–≤:**

```json
{
  "start_date": "2025-12-15",
  "end_date": "2025-12-21",
  "timezone": "Europe/Moscow",
  "filters": { "activity_type": "learning", "sources": ["timer"] }
}
```

---

## 8) –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å, –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—å, –¥–æ—Å—Ç—É–ø

- **Scopes:** –¥–æ—Å—Ç—É–ø–µ–Ω —Ç–æ–ª—å–∫–æ –≤–ª–∞–¥–µ–ª—å—Ü—É –¥–∞–Ω–Ω—ã—Ö –∏–ª–∏ –¥–æ–≤–µ—Ä–µ–Ω–Ω–æ–º—É –∞–≥–µ–Ω—Ç—É.
    
- **Auth:** –ø—Ä–æ–≤–µ—Ä–∫–∞ JWT-—Ç–æ–∫–µ–Ω–∞ –∏–ª–∏ OAuth2 Access Token.
    
- **–ê—É–¥–∏—Ç:** –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è user_id, timestamp, –¥–∏–∞–ø–∞–∑–æ–Ω –¥–∞—Ç.
    
- **–ü—Ä–∏–Ω—Ü–∏–ø –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏–∏:** tool –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–æ–ª—å–∫–æ –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —á–∏—Å–ª–∞, –±–µ–∑ —Å–æ–±—ã—Ç–∏–π.
    

---

## 9) –ù–∞–±–ª—é–¥–∞–µ–º–æ—Å—Ç—å (observability)

- latency p50/p95;
    
- error rate;
    
- –ø—Ä–æ—Ü–µ–Ω—Ç `NO_DATA` –∏ `PARTIAL_DATA`;
    
- —Å—Ä–µ–¥–Ω–∏–π `coverage_ratio`;
    
- —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞ `request_id ‚Üí –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –¥–∞–Ω–Ω—ã—Ö`;
    
- –º–µ—Ç—Ä–∏–∫–∞ ¬´tool_selected_vs_tool_needed¬ª –≤ –æ–±—É—á–∞—é—â–∏—Ö —Å—Ç–µ–Ω–¥–∞—Ö.
    

---

## 10) –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

- **–ù–µ–π–º–∏–Ω–≥:** `dt.get_time_invested_summary`.
    
- **v1.0** ‚Äî –ø–µ—Ä–≤–∞—è —Å—Ç–∞–±–∏–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è (21.12.2025).
    
- **v1.1 (–ø–ª–∞–Ω):** –¥–æ–±–∞–≤–∏—Ç—å `confidence` –∏ `trend_vs_previous_period`.
    
- **Deprecated:** –Ω–µ—Ç.
    
- **–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å:** –Ω–æ–≤—ã–µ –ø–æ–ª—è –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –±–µ–∑ breaking changes (MINOR).
    

---

## üìö –°–≤—è–∑–∞–Ω–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

|URI|–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ|
|---|---|
|`dt://catalogs/metrics`|–ö–∞—Ç–∞–ª–æ–≥ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π –º–µ—Ç—Ä–∏–∫|
|`dt://schemas/activity_event`|–°—Ö–µ–º–∞ —Å–æ–±—ã—Ç–∏—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏|
|`dt://policies/data_quality`|–ü–æ—Ä–æ–≥–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è coverage/confidence|
|`dt://changelog`|–ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤|

---

–ï—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ, —è –º–æ–≥—É –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –æ—Ñ–æ—Ä–º–∏—Ç—å **resource `dt://catalogs/metrics`** ‚Äî —Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ–º –º–µ—Ç—Ä–∏–∫–∏ `time_invested_minutes`, –ø—Ä–∞–≤–∏–ª–∞–º–∏ –∞–≥—Ä–µ–≥–∞—Ü–∏–∏ –∏ –∏—Å–∫–ª—é—á–µ–Ω–∏—è–º–∏.  
–°–¥–µ–ª–∞—Ç—å —ç—Ç–æ –∫–∞–∫ —Å–ª–µ–¥—É—é—â–∏–π —à–∞–≥?