# Структура репозитория руководств

> **Статус:** draft
> **Семейство:** F0 (Управление знаниями)
> **Автор:** Claude
> **Дата:** 2025-12-23

## 0. Назначение документа

Спецификация структуры репозитория для хранения руководств по трём программам развития:
- **C.Program.PersonalDevelopment** — Личное развитие
- **C.Program.WorkDevelopment** — Рабочее развитие
- **C.Program.ResearchDevelopment** — Исследовательское развитие

**Потребители:**
- Архитектор (развёртывание)
- ИИ-системы (через MCP-сервер)
- Авторы руководств (обновление через Markdown)

---

## 1. Архитектурное решение: модульная структура

### 1.1 Ключевые решения

| Вопрос | Решение | Обоснование |
|--------|---------|-------------|
| Один файл или много? | **Много файлов** (1 глава = 1 файл) | Параллельное редактирование, гранулярный доступ MCP |
| Где картинки? | **Рядом с главой** в `assets/` | Локальность ссылок, простота переноса |
| Нумерация | **Иерархическая** (P.G.C) | Программа.Руководство.Глава |
| Метаданные | **YAML frontmatter** | Совместимость с существующим репозиторием |
| Методология | **Отдельная папка `_meta/`** | Чёткое разделение контента и мета-инструкций |

### 1.2 Принцип: Guide = Unit of Deployment

Каждое руководство — **самодостаточный пакет**:
```
guide-folder/
├── index.md          ← Оглавление + метаданные руководства
├── chapters/         ← Главы (контент)
├── assets/           ← Медиа (картинки, таблицы)
└── _check/           ← Материалы для ДЗ-чекера
```

---

## 2. Полная структура репозитория

```
guides-repo/
│
├── README.md                           ← Описание репозитория
├── STRUCTURE.md                        ← Этот документ
├── manifest.json                       ← Машиночитаемый манифест для MCP
│
├── _meta/                              ← МЕТОДОЛОГИЯ (для ИИ-генерации)
│   ├── glossary.md                     ← Общий глоссарий терминов
│   ├── concepts/                       ← Базовые понятия
│   │   ├── index.md
│   │   ├── systems-thinking.md
│   │   ├── roles-model.md
│   │   └── ...
│   ├── templates/                      ← Шаблоны документов
│   │   ├── guide-template.md
│   │   ├── chapter-template.md
│   │   ├── homework-template.md
│   │   └── rubric-template.md
│   ├── rubrics/                        ← Общие рубрики оценки
│   │   ├── text-quality.md
│   │   ├── systems-analysis.md
│   │   └── ...
│   └── generation-rules.md             ← Правила генерации ИИ
│
├── programs/                           ← ТРИ ПРОГРАММЫ
│   │
│   ├── 1-personal/                     ← Личное развитие
│   │   ├── program.md                  ← Описание программы
│   │   ├── roadmap.md                  ← Маршрут прохождения
│   │   │
│   │   ├── 1.1-systems-thinking/       ← Руководство 1
│   │   │   ├── index.md
│   │   │   ├── chapters/
│   │   │   │   ├── 01-introduction.md
│   │   │   │   ├── 02-systems-levels.md
│   │   │   │   ├── 03-boundaries.md
│   │   │   │   └── ...
│   │   │   ├── assets/
│   │   │   │   ├── images/
│   │   │   │   │   ├── fig-01-system-model.png
│   │   │   │   │   └── ...
│   │   │   │   └── tables/
│   │   │   │       └── table-01-levels.csv
│   │   │   └── _check/
│   │   │       ├── questions.md
│   │   │       └── rubrics.md
│   │   │
│   │   ├── 1.2-time-management/        ← Руководство 2
│   │   │   └── ...
│   │   │
│   │   └── 1.3-note-taking/            ← Руководство 3
│   │       └── ...
│   │
│   ├── 2-work/                         ← Рабочее развитие
│   │   ├── program.md
│   │   ├── roadmap.md
│   │   ├── 2.1-project-work/
│   │   ├── 2.2-team-collaboration/
│   │   └── 2.3-stakeholder-comms/
│   │
│   └── 3-research/                     ← Исследовательское развитие
│       ├── program.md
│       ├── roadmap.md
│       ├── 3.1-hypothesis-design/
│       ├── 3.2-experiment-method/
│       └── 3.3-knowledge-synthesis/
│
└── .mcp/                               ← Конфигурация MCP-сервера
    ├── config.yaml
    ├── endpoints.yaml
    └── access-policies.yaml
```

---

## 3. Форматы файлов

### 3.1 Манифест репозитория (`manifest.json`)

```json
{
  "version": "1.0",
  "updated": "2025-12-23",
  "programs": [
    {
      "id": "personal",
      "code": "C.Program.PersonalDevelopment",
      "path": "programs/1-personal",
      "guides": ["1.1-systems-thinking", "1.2-time-management", "1.3-note-taking"]
    },
    {
      "id": "work",
      "code": "C.Program.WorkDevelopment",
      "path": "programs/2-work",
      "guides": ["2.1-project-work", "2.2-team-collaboration", "2.3-stakeholder-comms"]
    },
    {
      "id": "research",
      "code": "C.Program.ResearchDevelopment",
      "path": "programs/3-research",
      "guides": ["3.1-hypothesis-design", "3.2-experiment-method", "3.3-knowledge-synthesis"]
    }
  ],
  "meta": {
    "glossary": "_meta/glossary.md",
    "templates": "_meta/templates/",
    "rubrics": "_meta/rubrics/"
  }
}
```

### 3.2 Программа (`program.md`)

```yaml
---
id: C.Program.PersonalDevelopment
title: Личное развитие
status: active
version: 1.0
target_role: R.Student
outcome_role: R.Intellectual
guides_count: 3
estimated_hours: 120
---

# Личное развитие

## Цель программы
Развитие базовых практик интеллекта...

## Целевые результаты
- [ ] Освоено системное мышление
- [ ] Настроен экзокортекс
- [ ] ...

## Руководства программы
| № | Руководство | Часы | Статус |
|---|-------------|------|--------|
| 1.1 | Системное мышление | 40 | active |
| 1.2 | Управление временем | 30 | active |
| 1.3 | Ведение заметок | 50 | draft |
```

### 3.3 Индекс руководства (`index.md`)

```yaml
---
id: C.Guide.SystemsThinking
program: C.Program.PersonalDevelopment
code: "1.1"
title: Системное мышление
status: active
version: 2.3
created: 2024-01-15
modified: 2025-12-20

# FPF метаданные
family: F5
cell: "2.2.3"
trust:
  F: 8
  G: domain
  R: 0.9

# Структура
chapters_count: 12
estimated_hours: 40
prerequisites: []
unlocks: ["1.2-time-management"]

# Для ДЗ-чекера
homework_count: 8
rubric_ref: "_check/rubrics.md"

# Авторство
author: "Иванов И.И."
maintainers: ["Петров П.П."]
---

# Системное мышление

## Аннотация
Руководство по освоению системного мышления...

## Оглавление

| Глава | Название | Файл |
|-------|----------|------|
| 1 | Введение | chapters/01-introduction.md |
| 2 | Уровни систем | chapters/02-systems-levels.md |
| 3 | Границы систем | chapters/03-boundaries.md |
| ... | ... | ... |

## Домашние задания
| ДЗ | Глава | Тип | Файл вопросов |
|----|-------|-----|---------------|
| ДЗ-1 | 1-2 | text | _check/hw-01.md |
| ДЗ-2 | 3-4 | table | _check/hw-02.md |
| ... | ... | ... | ... |
```

### 3.4 Глава (`chapter.md`)

```yaml
---
guide: C.Guide.SystemsThinking
chapter: 2
title: Уровни систем
status: active
modified: 2025-12-15

# Контент
word_count: 2500
reading_time: 12
images: ["fig-01-levels.png", "fig-02-holarchy.png"]
tables: ["table-01-examples.csv"]

# Связи
depends_on: ["01-introduction"]
referenced_concepts: ["_meta/concepts/holonic-principle.md"]
---

# Глава 2. Уровни систем

## 2.1 Что такое уровень системы

Текст главы...

![Уровни системы](../assets/images/fig-01-levels.png)
*Рис. 2.1. Холархия уровней*

## 2.2 Примеры уровней

| Надсистема | Система | Подсистема |
|------------|---------|------------|
| Организм | Сердце | Клетки |
| ... | ... | ... |

> **Ключевая мысль:** Каждая система — холон (A.1 FPF)

## 2.3 Практика

Выполните упражнение...
```

### 3.5 Материалы для ДЗ-чекера (`_check/`)

#### questions.md
```yaml
---
guide: C.Guide.SystemsThinking
type: homework_questions
---

# Карта вопросов

## ДЗ-1: Введение в системы

### Вопрос 1.1
- **Тип:** open_text
- **Глава:** 1
- **Компетенция:** определение системы
- **Формулировка:** Опишите систему, с которой вы работаете...
- **Критерии:**
  - Названа целевая система
  - Указана надсистема
  - Определены границы

### Вопрос 1.2
- **Тип:** table
- **Глава:** 2
- **Формулировка:** Заполните таблицу уровней...
- **Шаблон:** |Уровень|Система|Функция|
```

#### rubrics.md
```yaml
---
guide: C.Guide.SystemsThinking
type: assessment_rubrics
---

# Рубрики оценки

## Рубрика: Определение системы

| Балл | Критерий |
|------|----------|
| 0 | Система не названа |
| 1 | Названа, но не определена |
| 2 | Определена, но без границ |
| 3 | Полное определение с границами |

## Рубрика: Таблица уровней

| Балл | Критерий |
|------|----------|
| 0 | Таблица пустая |
| 1 | 1-2 уровня |
| 2 | 3+ уровней, есть ошибки |
| 3 | Корректная холархия |
```

---

## 4. Система нумерации

### 4.1 Иерархия кодов

```
P.G.C
│ │ └── Chapter (01-99)
│ └──── Guide (1-9)
└────── Program (1-3)

Примеры:
1.1.01 = Личное развитие → Системное мышление → Введение
2.3.05 = Рабочее развитие → Коммуникации → Глава 5
3.2.12 = Исследовательское → Эксперименты → Глава 12
```

### 4.2 Имена папок и файлов

| Элемент | Паттерн | Пример |
|---------|---------|--------|
| Программа | `{N}-{slug}/` | `1-personal/` |
| Руководство | `{P}.{G}-{slug}/` | `1.2-time-management/` |
| Глава | `{CC}-{slug}.md` | `05-delegation.md` |
| Картинка | `fig-{CC}-{name}.png` | `fig-03-matrix.png` |
| Таблица | `table-{CC}-{name}.csv` | `table-01-types.csv` |
| ДЗ | `hw-{CC}.md` | `hw-03.md` |

### 4.3 Идентификаторы в словаре сущностей

| Сущность | Формат ID | Пример |
|----------|-----------|--------|
| Программа | `C.Program.{Name}` | `C.Program.PersonalDevelopment` |
| Руководство | `C.Guide.{Name}` | `C.Guide.SystemsThinking` |
| Глава | `C.Chapter.{Guide}.{N}` | `C.Chapter.SystemsThinking.02` |
| ДЗ | `C.Homework.{Guide}.{N}` | `C.Homework.SystemsThinking.01` |

---

## 5. MCP-сервер: эндпоинты

### 5.1 Конфигурация (`.mcp/endpoints.yaml`)

```yaml
version: "1.0"
base_path: "/guides"

endpoints:
  # Навигация
  - path: /manifest
    method: GET
    description: Получить манифест всех программ и руководств
    returns: manifest.json

  - path: /programs
    method: GET
    description: Список программ
    returns: [{id, title, guides_count}]

  - path: /programs/{program_id}
    method: GET
    description: Детали программы с roadmap
    returns: program.md + roadmap.md

  # Руководства
  - path: /guides/{guide_code}
    method: GET
    description: Индекс руководства
    returns: index.md

  - path: /guides/{guide_code}/chapters
    method: GET
    description: Список глав
    returns: [{chapter, title, status}]

  - path: /guides/{guide_code}/chapters/{chapter_num}
    method: GET
    description: Содержимое главы
    returns: chapter.md + resolved assets

  - path: /guides/{guide_code}/full
    method: GET
    description: Всё руководство целиком (для контекста)
    returns: concatenated chapters

  # ДЗ-чекер
  - path: /guides/{guide_code}/homework
    method: GET
    description: Все вопросы ДЗ
    returns: questions.md

  - path: /guides/{guide_code}/rubrics
    method: GET
    description: Рубрики оценки
    returns: rubrics.md

  - path: /guides/{guide_code}/check-context
    method: GET
    description: Полный контекст для проверки ДЗ
    returns: {chapters, questions, rubrics}

  # Методология
  - path: /meta/glossary
    method: GET
    description: Глоссарий терминов
    returns: glossary.md

  - path: /meta/concepts
    method: GET
    description: Список базовых понятий
    returns: [concept.md...]

  - path: /meta/templates/{template_name}
    method: GET
    description: Шаблон документа
    returns: template.md

  - path: /meta/generation-rules
    method: GET
    description: Правила генерации для ИИ
    returns: generation-rules.md

  # Поиск
  - path: /search
    method: GET
    params: {q: string, scope: program|guide|chapter}
    description: Полнотекстовый поиск
    returns: [{path, title, snippet, score}]
```

### 5.2 Политики доступа

```yaml
# .mcp/access-policies.yaml
policies:
  - role: AGT.HomeworkChecker
    allow:
      - /guides/*/check-context
      - /guides/*/rubrics
      - /meta/rubrics/*

  - role: AGT.RouteGuide
    allow:
      - /manifest
      - /programs/*
      - /guides/*/chapters/*
      - /meta/glossary

  - role: AGT.ContentGenerator
    allow:
      - /meta/*
      - /guides/*/full
```

---

## 6. Процессы обновления

### 6.1 Workflow авторов

```
┌─────────────────┐    ┌──────────────┐    ┌─────────────┐
│  Obsidian /     │───▶│  Git Push    │───▶│  CI/CD      │
│  VSCode         │    │  (PR)        │    │  Validation │
└─────────────────┘    └──────────────┘    └─────────────┘
                                                  │
                              ┌───────────────────┘
                              ▼
                       ┌─────────────┐    ┌─────────────┐
                       │  Merge to   │───▶│  MCP Cache  │
                       │  main       │    │  Invalidate │
                       └─────────────┘    └─────────────┘
```

### 6.2 Валидация CI

```yaml
# .github/workflows/validate-guides.yaml
checks:
  - frontmatter_required_fields
  - chapter_numbering_sequence
  - image_refs_exist
  - table_csv_valid
  - rubric_format_valid
  - manifest_sync
```

---

## 7. Преимущества структуры

| Требование | Как решено |
|------------|------------|
| **Гранулярный доступ MCP** | Каждая глава — отдельный файл |
| **Параллельное редактирование** | Авторы работают в разных файлах |
| **Версионирование** | Git + frontmatter version |
| **ДЗ-чекер** | `_check/` с вопросами и рубриками |
| **ИИ-генерация** | `_meta/` с шаблонами и правилами |
| **Локальность медиа** | `assets/` рядом с контентом |
| **Устойчивая нумерация** | Иерархическая P.G.C |
| **Расширяемость** | Новые программы/руководства по паттерну |

---

## 8. Чеклист для архитектора

- [ ] Создать корневую структуру папок
- [ ] Настроить `manifest.json`
- [ ] Развернуть MCP-сервер с эндпоинтами
- [ ] Настроить CI/CD валидацию
- [ ] Создать первое руководство по шаблону
- [ ] Протестировать доступ ДЗ-чекера
- [ ] Документировать процесс добавления руководства

---

## 9. Открытые вопросы

1. **Локализация:** Нужны ли версии на других языках?
2. **Версионирование руководств:** Хранить ли старые версии?
3. **Права доступа:** Разные уровни для разных ролей?
4. **Кэширование MCP:** Как инвалидировать при обновлении?

---

*Документ создан для архитектора экосистемы развития.*
