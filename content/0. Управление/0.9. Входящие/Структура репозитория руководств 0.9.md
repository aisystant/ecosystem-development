# Структура репозитория руководств

> **Статус:** draft
> **Семейство:** F0 (Управление знаниями)
> **Автор:** Claude
> **Дата:** 2025-12-23
> **Версия:** 0.9

## 0. Назначение документа

Спецификация структуры репозитория для хранения руководств образовательных программ Школы системного менеджмента.

**Потребители:**
- Архитектор (развёртывание)
- ИИ-системы (через MCP-сервер)
- ДЗ-чекер (проверка домашних заданий)
- Авторы руководств (обновление через Markdown)

**Источник названий руководств:** [system-school.ru/#programs](https://system-school.ru/#programs)

---

## 1. Архитектурное решение: иерархическая структура

### 1.1 Ключевые решения

| Вопрос | Решение | Обоснование |
|--------|---------|-------------|
| Структура руководства | **Папка с вложенными подпапками** | Руководство = папка, Раздел = подпапка, Подраздел = подпапка второго уровня |
| Один файл или много? | **Много файлов** (1 подраздел = 1 файл) | Параллельное редактирование, гранулярный доступ MCP |
| Где картинки? | **Рядом с разделом** в `assets/` | Локальность ссылок, простота переноса |
| Нумерация | **Иерархическая** (P.G.S.SS) | Программа.Руководство.Раздел.Подраздел |
| Метаданные | **YAML frontmatter** | Совместимость с существующим репозиторием |
| Методология | **Отдельная папка `_meta/`** | Чёткое разделение контента и мета-инструкций |
| Типы контента | **Полный и краткий** | Поддержка универсального руководства |

### 1.2 Иерархия контента

```
Руководство (папка)
├── Раздел (подпапка)
│   ├── Документ-подраздел.md      ← Файл с названием подраздела
│   ├── Подраздел (подпапка второго уровня)
│   │   └── Документ-подподраздел.md   ← Файл с названием подподраздела
│   └── assets/                    ← Медиа для раздела
└── _meta/                         ← Метаданные руководства
```

### 1.3 Принцип: Guide = Unit of Deployment

Каждое руководство — **самодостаточный пакет**:
```
1.1-self-development/                  ← РУКОВОДСТВО (код 1.1)
├── index.md                           ← Оглавление + метаданные
├── 01-attention/                      ← РАЗДЕЛ 01 (код 1.1.01)
│   ├── 01-pomodoro.md                 ← Подраздел 01 (код 1.1.01.01)
│   ├── 02-focus.md                    ← Подраздел 02 (код 1.1.01.02)
│   ├── 03-techniques/                 ← Подраздел 03 — папка (код 1.1.01.03)
│   │   ├── 01-timeboxing.md           ← Подподраздел 01 (код 1.1.01.03.01)
│   │   └── 02-batching.md             ← Подподраздел 02 (код 1.1.01.03.02)
│   └── assets/                        ← Медиа для раздела
├── 02-planning/                       ← РАЗДЕЛ 02 (код 1.1.02)
│   ├── 01-daily.md                    ← Подраздел 01 (код 1.1.02.01)
│   └── 02-weekly.md                   ← Подраздел 02 (код 1.1.02.02)
├── assets/                            ← Общие медиа руководства
└── _check/                            ← Материалы для ДЗ-чекера
```

### 1.4 SoTA-практики именования файлов

**Источники:** [MkDocs](https://www.mkdocs.org/user-guide/writing-your-docs/), [Docusaurus](https://docusaurus.io/docs/next/sidebar/autogenerated), [Harvard Data Management](https://datamanagement.hms.harvard.edu/plan-design/file-naming-conventions)

#### Два типа нумерации

| Тип | Назначение | Формат | Пример |
|-----|------------|--------|--------|
| **Физическая** | Сортировка файлов в ФС | Zero-padded префикс | `01-attention/`, `02-planning/` |
| **Логическая** | Ссылки, идентификаторы | Иерархия P.G.S.SS | `1.1.01.02` |

#### Правила физического именования (для сортировки)

1. **Zero-padding:** Всегда 2 цифры (01-99) для гарантии алфавитной сортировки
   - ✅ `01, 02, 03... 10, 11... 99`
   - ❌ `1, 2, 3... 10, 11` (10 встанет между 1 и 2)

2. **Разделитель:** Дефис `-` между номером и slug
   - ✅ `01-attention`
   - ❌ `01_attention`, `01.attention`

3. **Slug:** kebab-case, латиница, без спецсимволов
   - ✅ `self-development`, `systems-thinking`
   - ❌ `Self_Development`, `системное-мышление`

4. **Локальная нумерация:** Каждый уровень нумеруется с 01 внутри своей папки

#### Соответствие физического и логического кода

```
Физический путь                              Логический код
──────────────────────────────────────────   ─────────────────
programs/1-personal/                         1
  └─ 1.1-self-development/                   1.1
       ├─ 01-attention/                      1.1.01
       │    ├─ 01-pomodoro.md                1.1.01.01
       │    ├─ 02-focus.md                   1.1.01.02
       │    └─ 03-techniques/                1.1.01.03
       │         ├─ 01-timeboxing.md         1.1.01.03.01
       │         └─ 02-batching.md           1.1.01.03.02
       └─ 02-planning/                       1.1.02
            ├─ 01-daily.md                   1.1.02.01
            └─ 02-weekly.md                  1.1.02.02
```

### 1.5 Типы материалов в руководствах

| Тип | Описание | Применение |
|-----|----------|------------|
| **Полный текст** | Развёрнутое изложение подраздела | Основные руководства |
| **Краткий (concepts)** | Список понятий и ключевых идей | Универсальное руководство, справочники |
| **Смешанный** | Ключевые понятия + выборочные пояснения | Обзорные руководства |

**Краткие материалы** могут содержать:
- Список понятий с определениями
- Ключевые идеи и принципы
- Ссылки на полные материалы
- Контрольные вопросы

Из кратких материалов формируется **универсальное руководство** — сводный справочник понятий и идей.

---

## 2. Полная структура репозитория

### 2.1 Руководства из программ ШСМ

Названия руководств взяты из [system-school.ru](https://system-school.ru/#programs):

| Программа | Руководства |
|-----------|-------------|
| **1. Личное развитие** | Системное саморазвитие, Практики саморазвития, Введение в системное мышление, Системный фитнес |
| **2. Рабочее развитие** | Рациональная работа, Системное мышление, Методология, Системная инженерия, Инженерия личности, Системный менеджмент |
| **3. Исследовательское развитие** | Интеллект-стек |

### 2.2 Структура репозитория

```
guides-repo/
│
├── README.md                              ← Описание репозитория
├── STRUCTURE.md                           ← Этот документ
├── manifest.json                          ← Машиночитаемый манифест для MCP
│
├── _meta/                                 ← МЕТОДОЛОГИЯ (для ИИ-генерации)
│   ├── glossary.md                        ← Общий глоссарий терминов
│   ├── concepts/                          ← Базовые понятия
│   │   ├── index.md
│   │   ├── systems-thinking.md
│   │   ├── roles-model.md
│   │   └── ...
│   ├── templates/                         ← Шаблоны документов
│   │   ├── guide-template.md
│   │   ├── section-template.md
│   │   ├── subsection-template.md
│   │   ├── concepts-template.md           ← Шаблон кратких материалов
│   │   ├── homework-template.md
│   │   └── rubric-template.md
│   ├── rubrics/                           ← Общие рубрики оценки
│   │   ├── text-quality.md
│   │   ├── systems-analysis.md
│   │   └── ...
│   └── generation-rules.md                ← Правила генерации ИИ
│
├── programs/                              ← ТРИ ПРОГРАММЫ ШСМ
│   │
│   ├── 1-personal/                        ← Личное развитие
│   │   ├── program.md                     ← Описание программы
│   │   ├── roadmap.md                     ← Маршрут прохождения
│   │   │
│   │   ├── 1.1-self-development/          ← РУКОВОДСТВО: Системное саморазвитие
│   │   │   ├── index.md                   ← Оглавление + метаданные
│   │   │   ├── 01-attention/              ← РАЗДЕЛ: Внимание
│   │   │   │   ├── 01-pomodoro.md         ← ПОДРАЗДЕЛ (документ)
│   │   │   │   ├── 02-focus.md            ← ПОДРАЗДЕЛ (документ)
│   │   │   │   ├── 03-techniques/         ← ПОДРАЗДЕЛ (подпапка)
│   │   │   │   │   ├── 01-timeboxing.md   ← ПОДПОДРАЗДЕЛ (документ)
│   │   │   │   │   └── 02-batching.md     ← ПОДПОДРАЗДЕЛ (документ)
│   │   │   │   └── assets/
│   │   │   ├── 02-planning/               ← РАЗДЕЛ: Планирование
│   │   │   │   ├── 01-daily.md
│   │   │   │   ├── 02-weekly.md
│   │   │   │   └── ...
│   │   │   ├── assets/                    ← Общие медиа руководства
│   │   │   └── _check/                    ← Материалы для ДЗ-чекера
│   │   │       ├── questions.md
│   │   │       ├── rubrics.md
│   │   │       └── answers-key.md         ← Эталонные ответы (опционально)
│   │   │
│   │   ├── 1.2-practices/                 ← РУКОВОДСТВО: Практики саморазвития
│   │   │   └── ... (аналогичная структура)
│   │   │
│   │   ├── 1.3-intro-systems/             ← РУКОВОДСТВО: Введение в системное мышление
│   │   │   └── ...
│   │   │
│   │   └── 1.4-fitness/                   ← РУКОВОДСТВО: Системный фитнес
│   │       └── ...
│   │
│   ├── 2-work/                            ← Рабочее развитие
│   │   ├── program.md
│   │   ├── roadmap.md
│   │   ├── 2.1-rational-work/             ← РУКОВОДСТВО: Рациональная работа
│   │   ├── 2.2-systems-thinking/          ← РУКОВОДСТВО: Системное мышление
│   │   ├── 2.3-methodology/               ← РУКОВОДСТВО: Методология
│   │   ├── 2.4-systems-engineering/       ← РУКОВОДСТВО: Системная инженерия
│   │   ├── 2.5-personality-engineering/   ← РУКОВОДСТВО: Инженерия личности
│   │   └── 2.6-systems-management/        ← РУКОВОДСТВО: Системный менеджмент
│   │
│   └── 3-research/                        ← Исследовательское развитие
│       ├── program.md
│       ├── roadmap.md
│       └── 3.1-intellect-stack/           ← РУКОВОДСТВО: Интеллект-стек
│
└── .mcp/                                  ← Конфигурация MCP-сервера
    ├── config.yaml
    ├── endpoints.yaml
    ├── access-policies.yaml
    └── hw-checker-config.yaml             ← Конфигурация ДЗ-чекера
```

---

## 3. Форматы файлов

### 3.1 Манифест репозитория (`manifest.json`)

```json
{
  "version": "1.0",
  "updated": "2025-12-23",
  "programs": [
    {
      "id": "personal",
      "code": "C.Program.PersonalDevelopment",
      "title": "Личное развитие",
      "path": "programs/1-personal",
      "guides": [
        {"code": "1.1", "slug": "self-development", "title": "Системное саморазвитие"},
        {"code": "1.2", "slug": "practices", "title": "Практики саморазвития"},
        {"code": "1.3", "slug": "intro-systems", "title": "Введение в системное мышление"},
        {"code": "1.4", "slug": "fitness", "title": "Системный фитнес"}
      ]
    },
    {
      "id": "work",
      "code": "C.Program.WorkDevelopment",
      "title": "Рабочее развитие",
      "path": "programs/2-work",
      "guides": [
        {"code": "2.1", "slug": "rational-work", "title": "Рациональная работа"},
        {"code": "2.2", "slug": "systems-thinking", "title": "Системное мышление"},
        {"code": "2.3", "slug": "methodology", "title": "Методология"},
        {"code": "2.4", "slug": "systems-engineering", "title": "Системная инженерия"},
        {"code": "2.5", "slug": "personality-engineering", "title": "Инженерия личности"},
        {"code": "2.6", "slug": "systems-management", "title": "Системный менеджмент"}
      ]
    },
    {
      "id": "research",
      "code": "C.Program.ResearchDevelopment",
      "title": "Исследовательское развитие",
      "path": "programs/3-research",
      "guides": [
        {"code": "3.1", "slug": "intellect-stack", "title": "Интеллект-стек"}
      ]
    }
  ],
  "meta": {
    "glossary": "_meta/glossary.md",
    "templates": "_meta/templates/",
    "rubrics": "_meta/rubrics/"
  }
}
```

### 3.2 Программа (`program.md`)

```yaml
---
id: C.Program.PersonalDevelopment
title: Личное развитие
status: active
version: 1.0
target_role: R.Student
outcome_role: R.Intellectual
guides_count: 3
estimated_hours: 120
---

# Личное развитие

## Цель программы
Развитие базовых практик интеллекта...

## Целевые результаты
- [ ] Освоено системное мышление
- [ ] Настроен экзокортекс
- [ ] ...

## Руководства программы
| № | Руководство | Часы | Статус |
|---|-------------|------|--------|
| 1.1 | Системное мышление | 40 | active |
| 1.2 | Управление временем | 30 | active |
| 1.3 | Ведение заметок | 50 | draft |
```

### 3.3 Индекс руководства (`index.md`)

```yaml
---
id: C.Guide.SelfDevelopment
program: C.Program.PersonalDevelopment
code: "1.1"
title: Системное саморазвитие
status: active
version: 2.3
created: 2024-01-15
modified: 2025-12-20

# FPF метаданные
family: F5
cell: "2.2.3"
trust:
  F: 8
  G: domain
  R: 0.9

# Структура (иерархическая)
structure:
  sections_count: 5           # Количество разделов (папок первого уровня)
  subsections_count: 24       # Общее количество подразделов
  content_type: full          # full | concepts | mixed

estimated_hours: 40
prerequisites: []
unlocks: ["1.2-practices"]

# Для ДЗ-чекера
homework:
  count: 8
  questions_file: "_check/questions.md"
  rubrics_file: "_check/rubrics.md"
  answers_key: "_check/answers-key.md"  # опционально

# Авторство
author: "Иванов И.И."
maintainers: ["Петров П.П."]
---

# Системное саморазвитие

## Аннотация
Руководство по освоению практик системного саморазвития...

## Структура руководства

| Раздел | Название | Папка | Подразделов |
|--------|----------|-------|-------------|
| 1 | Внимание | 01-attention/ | 5 |
| 2 | Планирование | 02-planning/ | 4 |
| 3 | Заметки | 03-notes/ | 6 |
| ... | ... | ... | ... |

## Подробное оглавление

### Раздел 1. Внимание (`01-attention/`)

| Подраздел | Название | Файл/Папка |
|-----------|----------|------------|
| 1.1 | Техника Pomodoro | 01-pomodoro.md |
| 1.2 | Фокусировка | 02-focus.md |
| 1.3 | Техники управления | 03-techniques/ |
| 1.3.1 | Timeboxing | 03-techniques/01-timeboxing.md |
| 1.3.2 | Batching | 03-techniques/02-batching.md |

### Раздел 2. Планирование (`02-planning/`)

| Подраздел | Название | Файл |
|-----------|----------|------|
| 2.1 | Ежедневное планирование | 01-daily.md |
| 2.2 | Недельное планирование | 02-weekly.md |
| ... | ... | ... |

## Домашние задания
| ДЗ | Раздел | Тип | Файл вопросов |
|----|--------|-----|---------------|
| ДЗ-1 | 1-2 | text | _check/hw-01.md |
| ДЗ-2 | 3 | table | _check/hw-02.md |
| ... | ... | ... | ... |
```

### 3.4 Подраздел — полный текст (`subsection.md`)

```yaml
---
guide: C.Guide.SelfDevelopment
section: 01-attention
subsection: "1.1"
title: Техника Pomodoro
status: active
modified: 2025-12-15

# Тип контента
content_type: full          # full | concepts | mixed

# Контент
word_count: 2500
reading_time: 12
images: ["fig-01-pomodoro.png"]
tables: []

# Связи
depends_on: []
referenced_concepts: ["_meta/concepts/attention.md"]
---

# 1.1. Техника Pomodoro

## Что такое Pomodoro

Текст подраздела...

![Цикл Pomodoro](../assets/fig-01-pomodoro.png)
*Рис. 1.1. Цикл работы по методу Pomodoro*

## Применение техники

| Этап | Длительность | Действие |
|------|--------------|----------|
| Работа | 25 мин | Сфокусированная работа |
| Отдых | 5 мин | Короткий перерыв |
| ... | ... | ... |

> **Ключевая мысль:** Pomodoro помогает управлять вниманием

## Практика

Выполните упражнение...
```

### 3.5 Подраздел — краткий формат (concepts)

Для материалов, которые содержат **список понятий и ключевых идей** (используется в универсальном руководстве):

```yaml
---
guide: C.Guide.SelfDevelopment
section: 01-attention
subsection: "1.1"
title: Техника Pomodoro
status: active
modified: 2025-12-15

# Тип контента
content_type: concepts       # Краткий формат — список понятий

# Ссылка на полный текст
full_text_ref: "programs/1-personal/1.1-self-development/01-attention/01-pomodoro.md"
---

# 1.1. Техника Pomodoro (понятия)

## Ключевые понятия

| Понятие | Определение |
|---------|-------------|
| **Pomodoro** | Единица работы длительностью 25 минут |
| **Фокусировка** | Состояние концентрации на одной задаче |
| **Прерывание** | Внешнее или внутреннее отвлечение |

## Ключевые идеи

1. Работа интервалами повышает продуктивность
2. Регулярные перерывы предотвращают выгорание
3. Отслеживание прерываний помогает их минимизировать

## Связанные понятия

- [[Внимание]]
- [[Концентрация]]
- [[Тайм-менеджмент]]

## Контрольные вопросы

- Какова оптимальная длительность одного «помидора»?
- Как реагировать на прерывания во время работы?
```

### 3.6 Материалы для ДЗ-чекера (`_check/`)

#### questions.md
```yaml
---
guide: C.Guide.SystemsThinking
type: homework_questions
---

# Карта вопросов

## ДЗ-1: Введение в системы

### Вопрос 1.1
- **Тип:** open_text
- **Глава:** 1
- **Компетенция:** определение системы
- **Формулировка:** Опишите систему, с которой вы работаете...
- **Критерии:**
  - Названа целевая система
  - Указана надсистема
  - Определены границы

### Вопрос 1.2
- **Тип:** table
- **Глава:** 2
- **Формулировка:** Заполните таблицу уровней...
- **Шаблон:** |Уровень|Система|Функция|
```

#### rubrics.md
```yaml
---
guide: C.Guide.SystemsThinking
type: assessment_rubrics
---

# Рубрики оценки

## Рубрика: Определение системы

| Балл | Критерий |
|------|----------|
| 0 | Система не названа |
| 1 | Названа, но не определена |
| 2 | Определена, но без границ |
| 3 | Полное определение с границами |

## Рубрика: Таблица уровней

| Балл | Критерий |
|------|----------|
| 0 | Таблица пустая |
| 1 | 1-2 уровня |
| 2 | 3+ уровней, есть ошибки |
| 3 | Корректная холархия |
```

---

## 4. Система нумерации

> См. также: [1.4 SoTA-практики именования файлов](#14-sota-практики-именования-файлов)

### 4.1 Логическая иерархия кодов

Логический код используется для **ссылок, идентификации и навигации**.

```
P.G.SS.SS.SS
│ │  │  │  └── Подподраздел (01-99)
│ │  │  └───── Подраздел (01-99)
│ │  └──────── Раздел (01-99)
│ └──────────── Руководство (1-9)
└────────────── Программа (1-3)

Примеры:
1.1.01.02       = Личное развитие → Саморазвитие → Раздел 01 → Подраздел 02
1.4.01.03.01    = Личное развитие → Системный фитнес → Раздел 01 → Подраздел 03 → Подподраздел 01
2.2.05.01       = Рабочее развитие → Системное мышление → Раздел 05 → Подраздел 01
2.6.02.03       = Рабочее развитие → Системный менеджмент → Раздел 02 → Подраздел 03
```

### 4.2 Физическая нумерация (имена файлов)

Физический префикс используется для **сортировки файлов в файловой системе**.

| Уровень | Логический код | Физический путь | Пример |
|---------|----------------|-----------------|--------|
| Программа | `P` | `{P}-{slug}/` | `1-personal/` |
| Руководство | `P.G` | `{P}.{G}-{slug}/` | `1.1-self-development/` |
| Раздел | `P.G.SS` | `{SS}-{slug}/` | `01-attention/` |
| Подраздел (файл) | `P.G.SS.SS` | `{SS}-{slug}.md` | `02-focus.md` |
| Подраздел (папка) | `P.G.SS.SS` | `{SS}-{slug}/` | `03-techniques/` |
| Подподраздел | `P.G.SS.SS.SS` | `{SS}-{slug}.md` | `01-timeboxing.md` |

**Правила zero-padding:**
- Программы и руководства: без padding (1-3, 1-9)
- Разделы, подразделы, подподразделы: 2 цифры (01-99)

### 4.3 Полный пример соответствия

```
Логический код   Физический путь
────────────────────────────────────────────────────────────────
1                programs/1-personal/
1.1              programs/1-personal/1.1-self-development/
1.1.01           programs/1-personal/1.1-self-development/01-attention/
1.1.01.01        programs/1-personal/1.1-self-development/01-attention/01-pomodoro.md
1.1.01.02        programs/1-personal/1.1-self-development/01-attention/02-focus.md
1.1.01.03        programs/1-personal/1.1-self-development/01-attention/03-techniques/
1.1.01.03.01     programs/1-personal/1.1-self-development/01-attention/03-techniques/01-timeboxing.md
1.1.01.03.02     programs/1-personal/1.1-self-development/01-attention/03-techniques/02-batching.md
1.1.02           programs/1-personal/1.1-self-development/02-planning/
1.1.02.01        programs/1-personal/1.1-self-development/02-planning/01-daily.md
```

### 4.4 Именование медиа и ДЗ

| Элемент | Паттерн | Пример |
|---------|---------|--------|
| Картинка | `fig-{SS}-{name}.png` | `fig-01-pomodoro-cycle.png` |
| Таблица | `table-{SS}-{name}.csv` | `table-02-schedule.csv` |
| ДЗ-файл | `hw-{SS}.md` | `hw-01.md` |

### 4.5 Идентификаторы в словаре сущностей

| Сущность | Формат ID | Пример |
|----------|-----------|--------|
| Программа | `C.Program.{Name}` | `C.Program.PersonalDevelopment` |
| Руководство | `C.Guide.{Name}` | `C.Guide.SelfDevelopment` |
| Раздел | `C.Section.{Guide}.{N}` | `C.Section.SelfDevelopment.01` |
| Подраздел | `C.Subsection.{Guide}.{S}.{N}` | `C.Subsection.SelfDevelopment.01.02` |
| Подподраздел | `C.Topic.{Guide}.{S}.{SS}.{N}` | `C.Topic.SelfDevelopment.01.03.01` |
| ДЗ | `C.Homework.{Guide}.{N}` | `C.Homework.SelfDevelopment.01` |

---

## 5. MCP-сервер: эндпоинты

### 5.1 Конфигурация (`.mcp/endpoints.yaml`)

```yaml
version: "1.0"
base_path: "/guides"

endpoints:
  # ═══════════════════════════════════════════════════════════════
  # НАВИГАЦИЯ
  # ═══════════════════════════════════════════════════════════════

  - path: /manifest
    method: GET
    description: Получить манифест всех программ и руководств
    returns: manifest.json

  - path: /programs
    method: GET
    description: Список программ
    returns: [{id, title, guides_count}]

  - path: /programs/{program_id}
    method: GET
    description: Детали программы с roadmap
    returns: program.md + roadmap.md

  # ═══════════════════════════════════════════════════════════════
  # РУКОВОДСТВА (иерархическая структура)
  # ═══════════════════════════════════════════════════════════════

  - path: /guides/{guide_code}
    method: GET
    description: Индекс руководства
    returns: index.md

  - path: /guides/{guide_code}/sections
    method: GET
    description: Список разделов (папок первого уровня)
    returns: [{section_num, title, subsections_count}]

  - path: /guides/{guide_code}/sections/{section_num}
    method: GET
    description: Содержимое раздела (список подразделов)
    returns: [{subsection_num, title, type: "file"|"folder"}]

  - path: /guides/{guide_code}/sections/{section_num}/subsections/{subsection_num}
    method: GET
    description: Содержимое подраздела (документ или список подподразделов)
    returns: subsection.md | [{topic_num, title}]

  - path: /guides/{guide_code}/full
    method: GET
    description: Всё руководство целиком (для контекста)
    returns: concatenated sections + subsections

  - path: /guides/{guide_code}/tree
    method: GET
    description: Полное дерево структуры руководства
    returns: {sections: [{title, subsections: [...]}]}

  # ═══════════════════════════════════════════════════════════════
  # ДЗ-ЧЕКЕР (специальные эндпоинты для проверки домашних заданий)
  # ═══════════════════════════════════════════════════════════════

  - path: /guides/{guide_code}/homework
    method: GET
    description: Все вопросы ДЗ руководства
    returns: questions.md

  - path: /guides/{guide_code}/homework/{hw_num}
    method: GET
    description: Конкретное домашнее задание
    returns: {questions, rubrics, related_sections}

  - path: /guides/{guide_code}/rubrics
    method: GET
    description: Все рубрики оценки руководства
    returns: rubrics.md

  - path: /guides/{guide_code}/check-context
    method: GET
    description: Полный контекст для проверки ДЗ
    returns: |
      {
        guide_info: index.md,
        sections: [section.md...],
        questions: questions.md,
        rubrics: rubrics.md,
        answers_key: answers-key.md (если есть)
      }

  - path: /guides/{guide_code}/check-context/{hw_num}
    method: GET
    description: Контекст для проверки конкретного ДЗ
    returns: |
      {
        hw_questions: [...],
        related_sections: [section.md...],
        rubrics: [...],
        expected_concepts: [...]
      }

  # ═══════════════════════════════════════════════════════════════
  # УНИВЕРСАЛЬНОЕ РУКОВОДСТВО (понятия и идеи)
  # ═══════════════════════════════════════════════════════════════

  - path: /universal/concepts
    method: GET
    description: Все понятия (краткие материалы)
    returns: [{concept, definition, guide_ref}]

  - path: /universal/concepts/by-guide/{guide_code}
    method: GET
    description: Понятия конкретного руководства
    returns: concepts.md

  - path: /universal/concepts/by-topic/{topic}
    method: GET
    description: Понятия по теме
    returns: concepts.md

  - path: /universal/ideas
    method: GET
    description: Ключевые идеи всех руководств
    returns: [{idea, description, guide_ref}]

  # ═══════════════════════════════════════════════════════════════
  # МЕТОДОЛОГИЯ
  # ═══════════════════════════════════════════════════════════════

  - path: /meta/glossary
    method: GET
    description: Глоссарий терминов
    returns: glossary.md

  - path: /meta/concepts
    method: GET
    description: Список базовых понятий
    returns: [concept.md...]

  - path: /meta/templates/{template_name}
    method: GET
    description: Шаблон документа
    returns: template.md

  - path: /meta/generation-rules
    method: GET
    description: Правила генерации для ИИ
    returns: generation-rules.md

  # ═══════════════════════════════════════════════════════════════
  # ПОИСК
  # ═══════════════════════════════════════════════════════════════

  - path: /search
    method: GET
    params:
      q: string                              # поисковый запрос
      scope: program|guide|section|universal # область поиска
      content_type: full|concepts|all        # тип контента
    description: Полнотекстовый поиск
    returns: [{path, title, snippet, score, content_type}]

  - path: /search/concepts
    method: GET
    params: {q: string}
    description: Поиск по понятиям
    returns: [{concept, definition, guide_ref, full_text_ref}]
```

### 5.2 Политики доступа

```yaml
# .mcp/access-policies.yaml
policies:
  # ДЗ-чекер — проверка домашних заданий
  - role: AGT.HomeworkChecker
    allow:
      - /guides/*/check-context          # Полный контекст для проверки
      - /guides/*/check-context/*        # Контекст конкретного ДЗ
      - /guides/*/homework               # Вопросы ДЗ
      - /guides/*/homework/*             # Конкретное ДЗ
      - /guides/*/rubrics                # Рубрики оценки
      - /meta/rubrics/*                  # Общие рубрики
      - /universal/concepts/*            # Понятия для проверки терминологии

  # Навигатор по руководствам
  - role: AGT.RouteGuide
    allow:
      - /manifest
      - /programs/*
      - /guides/*/sections/*
      - /guides/*/tree
      - /meta/glossary
      - /search

  # Генератор контента
  - role: AGT.ContentGenerator
    allow:
      - /meta/*
      - /guides/*/full
      - /universal/*

  # Сервис понятий (для универсального руководства)
  - role: AGT.ConceptsService
    allow:
      - /universal/*
      - /search/concepts
      - /guides/*/sections/*/subsections/*  # Доступ к кратким материалам
```

---

## 6. Процессы обновления

### 6.1 Workflow авторов

```
┌─────────────────┐    ┌──────────────┐    ┌─────────────┐
│  Obsidian /     │───▶│  Git Push    │───▶│  CI/CD      │
│  VSCode         │    │  (PR)        │    │  Validation │
└─────────────────┘    └──────────────┘    └─────────────┘
                                                  │
                              ┌───────────────────┘
                              ▼
                       ┌─────────────┐    ┌─────────────┐
                       │  Merge to   │───▶│  MCP Cache  │
                       │  main       │    │  Invalidate │
                       └─────────────┘    └─────────────┘
```

### 6.2 Валидация CI

```yaml
# .github/workflows/validate-guides.yaml
checks:
  - frontmatter_required_fields
  - chapter_numbering_sequence
  - image_refs_exist
  - table_csv_valid
  - rubric_format_valid
  - manifest_sync
```

---

## 7. Преимущества структуры

| Требование | Как решено |
|------------|------------|
| **Гранулярный доступ MCP** | Каждый подраздел — отдельный файл, разделы — папки |
| **Параллельное редактирование** | Авторы работают в разных папках/файлах |
| **Версионирование** | Git + frontmatter version |
| **ДЗ-чекер** | `_check/` с вопросами, рубриками, эталонными ответами |
| **Универсальное руководство** | Краткие материалы (concepts) собираются в `universal/` |
| **Типы контента** | full / concepts / mixed — поддержка разных форматов |
| **ИИ-генерация** | `_meta/` с шаблонами и правилами |
| **Локальность медиа** | `assets/` на уровне раздела и руководства |
| **Устойчивая нумерация** | Иерархическая P.G.S.SS.SSS |
| **Расширяемость** | Новые программы/руководства по паттерну |
| **Реальные названия** | Названия из [system-school.ru](https://system-school.ru/#programs) |

---

## 8. Чеклист для архитектора

- [ ] Создать корневую структуру папок (programs/, universal/, _meta/, .mcp/)
- [ ] Настроить `manifest.json` с реальными названиями руководств
- [ ] Создать шаблоны в `_meta/templates/`:
  - [ ] guide-template.md
  - [ ] section-template.md
  - [ ] subsection-template.md (полный формат)
  - [ ] concepts-template.md (краткий формат)
- [ ] Развернуть MCP-сервер с эндпоинтами
- [ ] Настроить hw-checker-config.yaml для ДЗ-чекера
- [ ] Настроить CI/CD валидацию
- [ ] Создать первое руководство по шаблону (иерархическая структура)
- [ ] Протестировать:
  - [ ] Доступ ДЗ-чекера к `/check-context`
  - [ ] Работу с универсальным руководством (`/universal/concepts`)
  - [ ] Навигацию по иерархии (`/guides/*/tree`)
- [ ] Документировать процесс добавления руководства

---

## 9. Открытые вопросы

1. **Локализация:** Нужны ли версии на других языках?
2. **Версионирование руководств:** Хранить ли старые версии?
3. **Права доступа:** Разные уровни для разных ролей?
4. **Кэширование MCP:** Как инвалидировать при обновлении?

---

*Документ создан для архитектора экосистемы развития.*
