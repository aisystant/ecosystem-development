# Архитектурные решения и обоснования (ADR)

## ADR-001: Выбор OpenAI Apps SDK

**Статус:** Принято

**Контекст:**
Нужна платформа для ИИ-ассистента с UI. Варианты: собственный сайт, Telegram бот, Claude API, OpenAI Apps SDK.

**Решение:**
Использовать OpenAI Apps SDK для интеграции в ChatGPT.

**Обоснование:**
- Пользователи уже знают ChatGPT
- Не нужно поддерживать собственную инфраструктуру LLM
- Готовый UI-фреймворк
- Простая дистрибуция через каталог

**Последствия:**
- Зависимость от OpenAI
- Ограничения платформы
- Необходимость следовать гайдлайнам

---

## ADR-002: MCP вместо прямого API

**Статус:** Принято

**Контекст:**
Как связать ChatGPT с Цифровым двойником? Варианты: прямой REST API, OpenAI Functions, MCP.

**Решение:**
Использовать Model Context Protocol (MCP).

**Обоснование:**
- Стандартный протокол для LLM-интеграций
- Типизированные контракты
- Поддержка от Anthropic и сообщества
- Возможность использовать с другими LLM

**Последствия:**
- Дополнительный слой абстракции
- Необходимость поддерживать MCP-сервер
- Лучшая переносимость

---

## ADR-003: Cloudflare Workers для MCP-сервера

**Статус:** Принято

**Контекст:**
Где хостить MCP-сервер? Варианты: AWS Lambda, Vercel, Cloudflare Workers, собственный сервер.

**Решение:**
Cloudflare Workers.

**Обоснование:**
- Edge-расположение — быстрый ответ
- Простой деплой
- Бесплатный тир для старта
- Нет cold start

**Последствия:**
- Ограничения Workers (CPU time, размер)
- Специфика Cloudflare runtime

---

## ADR-004: Неделя как базовый период

**Статус:** Принято

**Контекст:**
Какой период показывать пользователю? Варианты: день, неделя, месяц, произвольный.

**Решение:**
Фиксированный период — текущая неделя (пн-вс).

**Обоснование:**
- Неделя — естественный цикл планирования
- Достаточно данных для паттернов
- Не перегружает информацией
- Простая реализация

**Последствия:**
- Нельзя смотреть другие периоды (Release 1)
- Нет сравнения с прошлыми неделями
- Понятный UX

---

## ADR-005: Демо-режим без идентификации

**Статус:** Принято

**Контекст:**
Как тестировать без реальных пользователей? Как показывать демо?

**Решение:**
Демо-режим с фиксированным `demo_twin_id` и предопределёнными данными.

**Обоснование:**
- Быстрый старт без OAuth
- Возможность показать разные сценарии
- Проверка UX до интеграции

**Последствия:**
- Нужны демо-данные
- Переключение демо/прод
- Риск путаницы у пользователей

---

**Связанные документы:**
- [[Описание-архитектуры-Apps-SDK+MCP+Двойник]]
- [[Концепция Проводника (Ассистент Ученика) 3.2]]
